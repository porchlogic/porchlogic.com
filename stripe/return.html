<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Payment Successful</title>
	<link rel="stylesheet" href="../styles/base.css">
</head>
<body class="bg-bg text-white flex flex-col items-center justify-center h-screen">
	<h1 class="font-stealth text-4xl text-neonGreen">Thank You!</h1>
	<p class="text-lg mt-4">Your purchase was successful.</p>


	<p>Status: <span id="status"></span></p>
	<p>Email: <span id="email"></span></p>

	<div id="activation-section" style="display:none;">
		<h3>Your Activation Code:</h3>
		<pre id="activation-code" style="font-size:1.5em; background:#eee; padding:10px;"></pre>
		<p>Please copy this code and paste it into your device config page.</p>
	</div>



	<a href="/" class="mt-6 px-6 py-3 text-lg border border-neonGreen text-neonGreen rounded-lg hover:bg-neonGreen hover:text-black transition">
		Back to Home
	</a>


	<script>
	const urlParams = new URLSearchParams(window.location.search);
	const sessionId = urlParams.get('session_id');

	if (!sessionId) {
		document.getElementById('status').textContent = 'No session ID found.';
	} else {
		fetch(`https://api.porchlogic.com/session-status?session_id=${sessionId}`)
			.then(r => {
				if (!r.ok) {
					throw new Error(`HTTP error! Status: ${r.status}`);
				}
				return r.json();
			})
			.then(data => {
				document.getElementById('status').textContent = data.status;
				document.getElementById('email').textContent = data.customer_email;

				if (data.activation_code) {
					document.getElementById('activation-code').textContent = data.activation_code;
					document.getElementById('activation-section').style.display = 'block';
				}
			})
			.catch(err => {
				console.error('Error fetching session status:', err);
				document.getElementById('status').textContent = 'Error fetching session status.';
			});
	}
</script>




</body>
</html>
